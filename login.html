Perfect! Here's the complete code with authentication fully integrated:

## **1. Create `login.html`** 

```html name=login.html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blacklingo - Login</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bcryptjs/2.4.3/bcrypt.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: #050816;
      color: #f5f5f5;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }

    .login-wrapper {
      width: 100%;
      max-width: 420px;
      padding: 16px;
    }

    .login-container {
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(148, 163, 184, 0.2);
      border-radius: 16px;
      padding: 40px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
    }

    .login-header {
      text-align: center;
      margin-bottom: 32px;
    }

    .login-header h1 {
      font-size: 32px;
      margin-bottom: 8px;
      background: linear-gradient(135deg, #22d3ee, #a855f7);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .login-header p {
      font-size: 12px;
      color: #9ca3af;
    }

    .tab-buttons {
      display: flex;
      gap: 8px;
      margin-bottom: 32px;
      background: rgba(31, 41, 55, 0.5);
      border-radius: 10px;
      padding: 4px;
    }

    .tab-btn {
      flex: 1;
      padding: 10px;
      border: none;
      background: transparent;
      color: #9ca3af;
      border-radius: 8px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .tab-btn.active {
      background: linear-gradient(135deg, #22d3ee, #a855f7);
      color: #0b1120;
    }

    .form-section {
      display: none;
    }

    .form-section.active {
      display: block;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .form-group {
      margin-bottom: 16px;
    }

    label {
      display: block;
      margin-bottom: 6px;
      font-size: 12px;
      color: #d1d5db;
      font-weight: 500;
    }

    input {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #4b5563;
      border-radius: 8px;
      background: rgba(2, 6, 23, 0.6);
      color: #e5e7eb;
      font-size: 13px;
      transition: all 0.3s ease;
    }

    input:focus {
      outline: none;
      border-color: #22d3ee;
      background: rgba(2, 6, 23, 0.9);
      box-shadow: 0 0 12px rgba(34, 211, 238, 0.2);
    }

    .submit-btn {
      width: 100%;
      padding: 10px;
      background: linear-gradient(135deg, #22d3ee, #a855f7);
      color: #0b1120;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      font-size: 13px;
      margin-top: 8px;
      transition: all 0.3s ease;
    }

    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(34, 211, 238, 0.3);
    }

    .submit-btn:active {
      transform: translateY(0);
    }

    .message {
      font-size: 12px;
      margin-top: 12px;
      padding: 10px;
      border-radius: 6px;
      text-align: center;
    }

    .error {
      color: #fecaca;
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
      display: none;
    }

    .error.show {
      display: block;
    }

    .success {
      color: #86efac;
      background: rgba(34, 197, 94, 0.1);
      border: 1px solid rgba(34, 197, 94, 0.3);
      display: none;
    }

    .success.show {
      display: block;
    }

    .loading {
      display: none;
      text-align: center;
      font-size: 12px;
      color: #22d3ee;
    }

    .loading.show {
      display: block;
    }

    @media (max-width: 500px) {
      .login-container {
        padding: 24px;
      }

      .login-header h1 {
        font-size: 24px;
      }
    }
  </style>
</head>
<body>
  <div class="login-wrapper">
    <div class="login-container">
      <div class="login-header">
        <h1>Blacklingo</h1>
        <p>Track dates, moods & achievements</p>
      </div>

      <div class="tab-buttons">
        <button class="tab-btn active" onclick="switchTab('login')">Login</button>
        <button class="tab-btn" onclick="switchTab('signup')">Sign Up</button>
      </div>

      <!-- LOGIN FORM -->
      <div id="login" class="form-section active">
        <div class="form-group">
          <label>Username</label>
          <input type="text" id="loginUsername" placeholder="Enter your username" autocomplete="username">
        </div>
        <div class="form-group">
          <label>Password</label>
          <input type="password" id="loginPassword" placeholder="Enter your password" autocomplete="current-password">
        </div>
        <button class="submit-btn" onclick="handleLogin()">Login</button>
        <div id="loginLoading" class="loading">Logging in...</div>
        <div id="loginError" class="message error"></div>
      </div>

      <!-- SIGNUP FORM -->
      <div id="signup" class="form-section">
        <div class="form-group">
          <label>Username</label>
          <input type="text" id="signupUsername" placeholder="Choose a username (3+ chars)" autocomplete="username">
        </div>
        <div class="form-group">
          <label>Password</label>
          <input type="password" id="signupPassword" placeholder="Create a password (6+ chars)" autocomplete="new-password">
        </div>
        <div class="form-group">
          <label>Confirm Password</label>
          <input type="password" id="signupConfirm" placeholder="Confirm your password" autocomplete="new-password">
        </div>
        <button class="submit-btn" onclick="handleSignup()">Create Account</button>
        <div id="signupLoading" class="loading">Creating account...</div>
        <div id="signupError" class="message error"></div>
        <div id="signupSuccess" class="message success"></div>
      </div>
    </div>
  </div>

  <script>
    // ===== USER MANAGER CLASS =====
    class UserManager {
      constructor() {
        this.usersKey = 'blacklingoUsers';
        this.currentUserKey = 'blacklingoCurrentUser';
      }

      getAllUsers() {
        const users = localStorage.getItem(this.usersKey);
        return users ? JSON.parse(users) : {};
      }

      userExists(username) {
        const users = this.getAllUsers();
        return users.hasOwnProperty(username.toLowerCase());
      }

      async registerUser(username, password) {
        const lowerUsername = username.toLowerCase();

        if (this.userExists(username)) {
          throw new Error('Username already exists');
        }
        if (username.length < 3) {
          throw new Error('Username must be at least 3 characters');
        }
        if (password.length < 6) {
          throw new Error('Password must be at least 6 characters');
        }
        if (!/^[a-zA-Z0-9_-]+$/.test(username)) {
          throw new Error('Username can only contain letters, numbers, underscores, and hyphens');
        }

        const hashedPassword = await bcrypt.hash(password, 10);
        const users = this.getAllUsers();

        users[lowerUsername] = {
          password: hashedPassword,
          createdAt: new Date().toISOString()
        };

        localStorage.setItem(this.usersKey, JSON.stringify(users));
        return true;
      }

      async loginUser(username, password) {
        const lowerUsername = username.toLowerCase();
        const users = this.getAllUsers();

        if (!users.hasOwnProperty(lowerUsername)) {
          throw new Error('Username not found');
        }

        const user = users[lowerUsername];
        const isValid = await bcrypt.compare(password, user.password);

        if (!isValid) {
          throw new Error('Incorrect password');
        }

        return lowerUsername;
      }

      getCurrentUser() {
        return localStorage.getItem(this.currentUserKey);
      }

      setCurrentUser(username) {
        localStorage.setItem(this.currentUserKey, username);
      }

      logout() {
        localStorage.removeItem(this.currentUserKey);
      }
    }

    const userManager = new UserManager();

    // ===== TAB SWITCHING =====
    function switchTab(tab) {
      document.querySelectorAll('.form-section').forEach(el => el.classList.remove('active'));
      document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
      document.getElementById(tab).classList.add('active');
      event.target.classList.add('active');

      // Clear messages
      document.getElementById('loginError').classList.remove('show');
      document.getElementById('signupError').classList.remove('show');
      document.getElementById('signupSuccess').classList.remove('show');
    }

    // ===== SIGNUP HANDLER =====
    async function handleSignup() {
      const username = document.getElementById('signupUsername').value.trim();
      const password = document.getElementById('signupPassword').value;
      const confirm = document.getElementById('signupConfirm').value;
      const errorEl = document.getElementById('signupError');
      const successEl = document.getElementById('signupSuccess');
      const loadingEl = document.getElementById('signupLoading');

      errorEl.classList.remove('show');
      successEl.classList.remove('show');

      try {
        if (!username) throw new Error('Username is required');
        if (!password) throw new Error('Password is required');
        if (password !== confirm) throw new Error('Passwords do not match');

        loadingEl.classList.add('show');
        await userManager.registerUser(username, password);
        loadingEl.classList.remove('show');

        successEl.textContent = '‚úì Account created! Switch to Login to sign in.';
        successEl.classList.add('show');

        document.getElementById('signupUsername').value = '';
        document.getElementById('signupPassword').value = '';
        document.getElementById('signupConfirm').value = '';

        setTimeout(() => {
          switchTab('login');
        }, 2000);
      } catch (err) {
        loadingEl.classList.remove('show');
        errorEl.textContent = '‚úó ' + err.message;
        errorEl.classList.add('show');
      }
    }

    // ===== LOGIN HANDLER =====
    async function handleLogin() {
      const username = document.getElementById('loginUsername').value.trim();
      const password = document.getElementById('loginPassword').value;
      const errorEl = document.getElementById('loginError');
      const loadingEl = document.getElementById('loginLoading');

      errorEl.classList.remove('show');

      try {
        if (!username) throw new Error('Username is required');
        if (!password) throw new Error('Password is required');

        loadingEl.classList.add('show');
        const loggedInUser = await userManager.loginUser(username, password);
        loadingEl.classList.remove('show');

        userManager.setCurrentUser(loggedInUser);
        window.location.href = 'index.html';
      } catch (err) {
        loadingEl.classList.remove('show');
        errorEl.textContent = '‚úó ' + err.message;
        errorEl.classList.add('show');
      }
    }

    // ===== AUTO REDIRECT IF ALREADY LOGGED IN =====
    if (userManager.getCurrentUser()) {
      window.location.href = 'index.html';
    }

    // ===== ENTER KEY SUPPORT =====
    document.getElementById('loginPassword').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') handleLogin();
    });
    document.getElementById('signupConfirm').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') handleSignup();
    });
  </script>
</body>
</html>
```

---

## **2. Updated `index.html` (With Auth)**

```html name=index.html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Blacklingo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="manifest" href="manifest.json">
  <style>
    :root{
      --bg-main:#050816;
      --card-bg:rgba(15,23,42,0.9);
      --card-border:rgba(148,163,184,0.2);
      --accent:#22d3ee;
      --accent-soft:#a855f7;
      --text-main:#f5f5f5;
      --text-muted:#9ca3af;
      --chip-bg:#020617;
      --danger:#b91c1c;
    }

    body{
      margin:0;
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:var(--bg-main);
      color:var(--text-main);
      display:flex;
      flex-direction:column;
      min-height:100vh;
      transition:background 0.3s ease,color 0.3s ease;
    }
    header{
      padding:10px 16px;
      background:rgba(10,10,30,0.95);
      display:flex;
      align-items:center;
      justify-content:space-between;
      box-shadow:0 2px 10px rgba(0,0,0,0.6);
      position:sticky;
      top:0;
      z-index:10;
    }
    #appTitle{font-weight:700;letter-spacing:0.06em;cursor:pointer;}
    .header-info{
      display:flex;
      align-items:center;
      gap:12px;
      font-size:12px;
    }
    .username-badge{
      background:rgba(34,211,238,0.1);
      border:1px solid rgba(34,211,238,0.3);
      padding:4px 8px;
      border-radius:999px;
      color:#22d3ee;
    }
    .nav-buttons{
      display:flex;
      align-items:center;
      gap:6px;
    }
    .nav-buttons button{
      margin-left:6px;
      padding:6px 10px;
      border-radius:999px;
      border:none;
      background:#1f2937;
      color:#f9fafb;
      cursor:pointer;
      font-size:13px;
      transition:all 0.3s ease;
    }
    .nav-buttons button:hover{background:#4b5563;}
    .nav-buttons button.logout{background:#b91c1c;}
    .nav-buttons button.logout:hover{background:#991b1b;}
    main{flex:1;padding:16px;max-width:950px;margin:0 auto;width:100%;}
    #landing{
      flex:1;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      text-align:center;
      padding:24px;
      gap:16px;
    }
    #landing h1{font-size:32px;margin:0;}
    #landing p{max-width:420px;color:#d1d5db;}
    #landing .primary-btn{
      padding:10px 18px;
      border-radius:999px;
      border:none;
      background:linear-gradient(135deg,var(--accent),var(--accent-soft));
      color:#0b1120;
      font-weight:600;
      cursor:pointer;
      margin-top:8px;
    }
    section{display:none;margin-top:8px;}
    h2{margin-top:0;font-size:20px;}
    .card{
      background:var(--card-bg);
      border-radius:16px;
      padding:14px;
      box-shadow:0 10px 30px rgba(0,0,0,0.6);
      margin-bottom:14px;
      border:1px solid var(--card-border);
      transition:background 0.3s ease,border-color 0.3s ease,transform 0.2s ease;
    }
    .card-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
      margin-bottom:8px;
    }
    .card-header h2{margin:0;}
    .pill{
      font-size:11px;
      padding:3px 8px;
      border-radius:999px;
      background:var(--chip-bg);
      border:1px solid rgba(148,163,184,0.4);
      color:#e5e7eb;
    }
    .field-row{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-bottom:10px;
    }
    .field-row input[type="date"],
    .field-row input[type="text"],
    .field-row select{
      flex:1;
      min-width:120px;
      padding:6px 8px;
      border-radius:999px;
      border:1px solid #4b5563;
      background:var(--chip-bg);
      color:#e5e7eb;
      font-size:13px;
    }
    .field-row button{
      padding:6px 10px;
      border-radius:999px;
      border:none;
      background:#22c55e;
      color:#022c22;
      font-weight:600;
      cursor:pointer;
      font-size:13px;
    }
    .field-row button:hover{background:#16a34a;}
    .date-toolbar{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-bottom:8px;
      align-items:center;
    }
    .date-toolbar input[type="text"]{
      flex:2;
      min-width:160px;
      padding:6px 8px;
      border-radius:999px;
      border:1px solid #4b5563;
      background:var(--chip-bg);
      color:#e5e7eb;
      font-size:13px;
    }
    .filter-group{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
    }
    .filter-btn{
      padding:4px 9px;
      border-radius:999px;
      border:1px solid #4b5563;
      background:var(--chip-bg);
      color:#e5e7eb;
      font-size:11px;
      cursor:pointer;
    }
    .filter-btn.active{
      background:var(--accent);
      color:#020617;
      border-color:var(--accent);
    }
    .date-item{
      display:grid;
      grid-template-columns:minmax(120px,1fr) minmax(120px,1.2fr) auto auto;
      gap:6px;
      align-items:center;
      padding:8px;
      border-radius:12px;
      background:var(--chip-bg);
      margin-bottom:6px;
      font-size:13px;
    }
    .date-item input[type="date"],
    .date-item .tagName,
    .date-item select{
      padding:4px 8px;
      border-radius:999px;
      border:1px solid #374151;
      background:var(--chip-bg);
      color:#e5e7eb;
      font-size:12px;
    }
    .date-item span.time-label{
      font-size:12px;
      text-align:right;
      color:#e5e7eb;
    }
    .pin-toggle{
      font-size:11px;
      display:flex;
      align-items:center;
      gap:4px;
      justify-content:flex-end;
    }
    .pin-toggle input{accent-color:#facc15;}
    .date-item button{
      padding:4px 8px;
      border-radius:999px;
      border:none;
      background:#ef4444;
      color:#fef2f2;
      cursor:pointer;
      font-size:11px;
    }
    .date-item button:hover{background:#b91c1c;}
    .pinned-label{
      font-size:10px;
      padding:2px 6px;
      border-radius:999px;
      background:rgba(250,204,21,0.1);
      border:1px solid rgba(250,204,21,0.6);
      color:#facc15;
      margin-left:4px;
    }
    ul{list-style:none;padding-left:0;margin:0;}
    .achievement-item{
      padding:8px 10px;
      border-radius:12px;
      margin-bottom:6px;
      font-size:13px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      border:1px solid rgba(148,163,184,0.3);
      background:var(--chip-bg);
    }
    .achievement-left{display:flex;flex-direction:column;}
    .achievement-name{font-weight:600;}
    .achievement-rarity{font-size:11px;opacity:0.8;}
    .rarity-common{color:#e5e7eb;}
    .rarity-rare{color:#22d3ee;}
    .rarity-epic{color:#f472b6;}
    .rarity-legendary{color:#facc15;}
    .achievement-item.unearned{opacity:0.35;filter:grayscale(0.7);}
    .achievement-item.earned{box-shadow:0 0 18px rgba(56,189,248,0.35);}
    .history-list li{
      font-size:12px;
      padding:4px 0;
      border-bottom:1px solid rgba(31,41,55,0.8);
    }
    .small-btn{
      padding:5px 9px;
      border-radius:999px;
      border:none;
      background:#1f2937;
      color:#e5e7eb;
      font-size:12px;
      cursor:pointer;
    }
    .small-btn.danger{background:var(--danger);}
    .small-btn:hover{background:#4b5563;}
    .countdown-display{
      font-size:16px;
      font-weight:600;
      margin-top:8px;
      text-align:center;
    }
    .countdown-item{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:6px 8px;
      border-radius:10px;
      background:var(--chip-bg);
      margin-top:6px;
      font-size:13px;
    }
    .countdown-item button{
      padding:4px 8px;
      border-radius:999px;
      border:none;
      font-size:11px;
      cursor:pointer;
      margin-left:4px;
    }
    .countdown-item button:first-of-type{background:#22c55e;color:#022c22;}
    .countdown-item button:last-of-type{background:#ef4444;color:#fef2f2;}
    .settings-row{
      display:flex;
      flex-direction:column;
      gap:6px;
      margin-bottom:10px;
      font-size:13px;
    }
    .settings-row input[type="color"]{
      width:60px;
      height:30px;
      border-radius:8px;
      border:none;
      padding:0;
      background:none;
    }
    .settings-row input[type="file"]{
      font-size:12px;
    }
    .settings-row input[type="text"]{
      padding:6px 8px;
      border-radius:999px;
      border:1px solid #4b5563;
      background:var(--chip-bg);
      color:#e5e7eb;
      font-size:13px;
    }
    .theme-buttons{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
    }
    .theme-btn{
      padding:5px 10px;
      border-radius:999px;
      border:1px solid #4b5563;
      background:var(--chip-bg);
      color:#e5e7eb;
      font-size:12px;
      cursor:pointer;
    }
    .theme-btn.active{
      border-color:var(--accent);
      box-shadow:0 0 12px rgba(34,211,238,0.6);
    }
    .theme-note{
      font-size:11px;
      color:var(--text-muted);
    }
    footer{
      padding:8px 12px;
      font-size:11px;
      text-align:center;
      color:var(--text-muted);
      background:rgba(15,23,42,0.95);
      border-top:1px solid rgba(31,41,55,0.9);
    }

    /* Insights + streak */
    .insights-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(150px,1fr));
      gap:8px;
      margin-top:6px;
      font-size:12px;
    }
    .insight-pill{
      padding:6px 8px;
      border-radius:12px;
      background:var(--chip-bg);
      border:1px solid rgba(148,163,184,0.3);
    }
    .insight-label{opacity:0.7;font-size:11px;}
    .insight-value{font-weight:600;margin-top:2px;}

    /* Achievement popup */
    #achievementPopup{
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      z-index:50;
      pointer-events:none;
    }
    #achievementPopupInner{
      min-width:260px;
      max-width:320px;
      background:var(--chip-bg);
      border-radius:18px;
      padding:14px 16px;
      border:1px solid rgba(148,163,184,0.6);
      box-shadow:0 20px 60px rgba(0,0,0,0.9);
      text-align:center;
    }
    #achievementPopupTitle{
      font-size:13px;
      text-transform:uppercase;
      letter-spacing:0.12em;
      color:#a5b4fc;
      margin-bottom:4px;
    }
    #achievementPopupName{
      font-size:17px;
      font-weight:700;
      margin-bottom:4px;
    }
    #achievementPopupRarity{
      font-size:12px;
      opacity:0.9;
      margin-bottom:6px;
    }
    #achievementPopupDesc{
      font-size:12px;
      color:#e5e7eb;
      opacity:0.9;
    }
    .popup-common{box-shadow:0 0 18px rgba(148,163,184,0.4);}
    .popup-rare{box-shadow:0 0 22px rgba(34,211,238,0.7);}
    .popup-epic{box-shadow:0 0 22px rgba(244,114,182,0.7);}
    .popup-legendary{box-shadow:0 0 26px rgba(250,204,21,0.9);}
    .anim-slide-up{animation:slideUp 0.6s ease-out;}
    .anim-pop-in{animation:popIn 0.55s cubic-bezier(0.34,1.56,0.64,1);}
    .anim-glow-pulse{animation:glowPulse 1.2s ease-out;}
    .anim-confetti{animation:confetti 0.9s ease-out;}
    @keyframes slideUp{
      from{transform:translateY(40px);opacity:0;}
      to{transform:translateY(0);opacity:1;}
    }
    @keyframes popIn{
      0%{transform:scale(0.4);opacity:0;}
      60%{transform:scale(1.05);opacity:1;}
      100%{transform:scale(1);opacity:1;}
    }
    @keyframes glowPulse{
      0%{transform:scale(0.9);box-shadow:0 0 0 rgba(56,189,248,0);}
      50%{transform:scale(1.03);box-shadow:0 0 30px rgba(56,189,248,0.9);}
      100%{transform:scale(1);box-shadow:0 0 10px rgba(56,189,248,0.4);}
    }
    @keyframes confetti{
      0%{transform:translateY(-20px) scale(0.8);opacity:0;}
      40%{transform:translateY(0) scale(1.05);opacity:1;}
      100%{transform:translateY(10px) scale(1);opacity:1;}
    }

    /* Extras neon cyber grid */
    #extrasSection{
      position:relative;
      overflow:hidden;
    }
    .extras-grid-bg{
      position:absolute;
      inset:0;
      background:
        linear-gradient(90deg, rgba(255,0,0,0.18), rgba(0,255,0,0.18), rgba(0,128,255,0.18)),
        radial-gradient(circle at top, rgba(56,189,248,0.25), transparent 55%),
        radial-gradient(circle at bottom, rgba(244,114,182,0.25), transparent 55%);
      mix-blend-mode:screen;
      opacity:0.7;
      pointer-events:none;
      animation:rgbGridPulse 12s infinite alternate;
    }
    .extras-grid-lines{
      position:absolute;
      inset:0;
      background-image:
        linear-gradient(rgba(148,163,184,0.12) 1px, transparent 1px),
        linear-gradient(90deg, rgba(148,163,184,0.12) 1px, transparent 1px);
      background-size:40px 40px;
      opacity:0.4;
      mix-blend-mode:soft-light;
      pointer-events:none;
    }
    .extras-scanlines{
      position:absolute;
      inset:0;
      background-image:linear-gradient(rgba(15,23,42,0.4) 1px, transparent 1px);
      background-size:100% 3px;
      opacity:0.35;
      mix-blend-mode:multiply;
      pointer-events:none;
      animation:scanlineMove 8s linear infinite;
    }
    @keyframes rgbGridPulse{
      0%{transform:translate3d(0,0,0);}
      50%{transform:translate3d(-10px,-10px,0);}
      100%{transform:translate3d(10px,10px,0);}
    }
    @keyframes scanlineMove{
      0%{background-position:0 0;}
      100%{background-position:0 100%;}
    }
    .extras-content{
      position:relative;
      z-index:2;
    }
    .extras-row{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
      gap:12px;
    }
    .extras-card{
      position:relative;
      border-radius:18px;
      padding:12px;
      background:radial-gradient(circle at top left, rgba(34,211,238,0.18), transparent 55%),
                 radial-gradient(circle at bottom right, rgba(244,114,182,0.18), transparent 55%),
                 rgba(15,23,42,0.96);
      border:1px solid rgba(148,163,184,0.5);
      box-shadow:0 0 18px rgba(15,23,42,0.9);
      overflow:hidden;
    }
    .extras-card::before{
      content:"";
      position:absolute;
      inset:-40%;
      background:conic-gradient(from 180deg, rgba(56,189,248,0.0), rgba(56,189,248,0.4), rgba(244,114,182,0.0));
      opacity:0;
      mix-blend-mode:screen;
      transition:opacity 0.3s ease;
      pointer-events:none;
    }
    .extras-card:hover::before{
      opacity:0.7;
      animation:spinGlow 6s linear infinite;
    }
    @keyframes spinGlow{
      0%{transform:rotate(0deg);}
      100%{transform:rotate(360deg);}
    }
    .extras-card h3{
      margin:0 0 6px 0;
      font-size:15px;
      letter-spacing:0.08em;
      text-transform:uppercase;
      color:#e5e7eb;
    }
    .extras-sub{
      font-size:11px;
      color:var(--text-muted);
      margin-bottom:6px;
    }
    .extras-quote{
      font-size:13px;
      line-height:1.4;
      margin-bottom:4px;
    }
    .extras-quote-author{
      font-size:11px;
      opacity:0.8;
    }
    .extras-mood-row{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-top:6px;
    }
    .mood-btn{
      padding:4px 8px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.6);
      background:rgba(15,23,42,0.9);
      color:#e5e7eb;
      font-size:12px;
      cursor:pointer;
    }
    .mood-btn.active{
      border-color:var(--accent);
      box-shadow:0 0 12px rgba(34,211,238,0.7);
    }
    .extras-secret-input{
      display:flex;
      gap:6px;
      margin-top:6px;
    }
    .extras-secret-input input{
      flex:1;
      padding:6px 8px;
      border-radius:999px;
      border:1px solid #4b5563;
      background:var(--chip-bg);
      color:#e5e7eb;
      font-size:12px;
    }
    .extras-secret-input button{
      padding:6px 10px;
      border-radius:999px;
      border:none;
      background:#22c55e;
      color:#022c22;
      font-size:12px;
      cursor:pointer;
    }
    .extras-theme-stats{
      font-size:12px;
      margin-top:4px;
    }
    .extras-theme-stats span{
      display:block;
      opacity:0.9;
    }
    .extras-hint{
      font-size:11px;
      color:var(--text-muted);
      margin-top:4px;
    }

    @media(max-width:700px){
      header{padding:8px 10px;}
      main{padding:10px;}
      .card{padding:10px;}
      #landing h1{font-size:26px;}
      .date-item{
        grid-template-columns:1fr;
        align-items:flex-start;
      }
      .date-item span.time-label{text-align:left;}
      .header-info{flex-direction:column;gap:4px;}
    }
  </style>
</head>
<body>
  <header>
    <div id="appTitle">Blacklingo</div>
    <div class="header-info">
      <span class="username-badge">üë§ <span id="usernameDisplay">User</span></span>
    </div>
    <div class="nav-buttons">
      <button onclick="goHome()">Home</button>
      <button onclick="showSection('datesSection')">Dates</button>
      <button onclick="showSection('countdownSection')">Countdown</button>
      <button onclick="showSection('achievementsSection')">Achievements</button>
      <button onclick="showSection('historySection')">History</button>
      <button onclick="showSection('settingsSection')">Settings</button>
      <button onclick="showSection('shareSection')">Share</button>
      <button onclick="showSection('extrasSection')">Extras</button>
      <button class="logout" onclick="logoutUser()">Logout</button>
    </div>
  </header>

  <main>
    <div id="landing">
      <h1>Blacklingo</h1>
      <p>Track your important dates, countdowns, moods, and milestones ‚Äî and unlock neon achievements as you go.</p>
      <button class="primary-btn" onclick="showSection('datesSection')">Start tracking</button>
    </div>

    <div id="mainApp">
      <!-- Dates -->
      <section id="datesSection">
        <div class="card">
          <div class="card-header">
            <h2>My Dates</h2>
            <span class="pill" id="streakPill">Streak: 0 ¬∑ Best: 0</span>
          </div>

          <!-- Insights -->
          <div class="insights-grid" id="insightsGrid">
            <div class="insight-pill">
              <div class="insight-label">Next upcoming</div>
              <div class="insight-value" id="insightNext">‚Äì</div>
            </div>
            <div class="insight-pill">
              <div class="insight-label">Most used tag</div>
              <div class="insight-value" id="insightTag">‚Äì</div>
            </div>
            <div class="insight-pill">
              <div class="insight-label">Oldest date</div>
              <div class="insight-value" id="insightOldest">‚Äì</div>
            </div>
            <div class="insight-pill">
              <div class="insight-label">Added this week</div>
              <div class="insight-value" id="insightWeek">0</div>
            </div>
          </div>

          <!-- Add row -->
          <div class="field-row" style="margin-top:10px;">
            <input type="date" id="dateInput">
            <input type="text" id="tagInput" placeholder="Tag name (e.g. Anniversary)">
            <select id="categoryInput">
              <option value="general">General</option>
              <option value="birthday">Birthday</option>
              <option value="anniversary">Anniversary</option>
              <option value="work">Work</option>
              <option value="school">School</option>
              <option value="personal">Personal</option>
            </select>
            <button id="addDateBtn">Add</button>
          </div>

          <!-- Toolbar -->
          <div class="date-toolbar">
            <input type="text" id="searchInput" placeholder="Search by tag, category, or text">
            <div class="filter-group">
              <button class="filter-btn active" data-filter="all">All</button>
              <button class="filter-btn" data-filter="birthday">Birthday</button>
              <button class="filter-btn" data-filter="anniversary">Anniversary</button>
              <button class="filter-btn" data-filter="work">Work</button>
              <button class="filter-btn" data-filter="school">School</button>
              <button class="filter-btn" data-filter="personal">Personal</button>
              <button class="filter-btn" data-filter="pinned">Pinned</button>
            </div>
          </div>

          <div id="results"></div>
        </div>
      </section>

      <!-- Countdown -->
      <section id="countdownSection">
        <div class="card">
          <h2>Countdown</h2>
          <div class="field-row">
            <input type="date" id="countdownDate">
            <input type="text" id="countdownName" placeholder="Countdown name">
          </div>
          <div class="field-row">
            <button id="startCountdownBtn">Start</button>
            <button id="saveCountdownBtn">Save</button>
          </div>
          <div id="countdownDisplay" class="countdown-display">No active countdown</div>
          <div id="savedCountdowns" style="margin-top:10px;"></div>
        </div>
      </section>

      <!-- Achievements -->
      <section id="achievementsSection">
        <div class="card">
          <h2>Achievements</h2>
          <ul id="badgeList"></ul>
        </div>
      </section>

      <!-- History -->
      <section id="historySection">
        <div class="card">
          <h2>History</h2>
          <button id="clearHistoryBtn" class="small-btn danger" style="margin-bottom:8px;">Clear all</button>
          <ul id="historyList" class="history-list"></ul>
        </div>
      </section>

      <!-- Settings -->
      <section id="settingsSection">
        <div class="card">
          <h2>Settings</h2>

          <div class="settings-row">
            <label>Theme</label>
            <div class="theme-buttons">
              <button class="theme-btn" data-theme="neon">Neon</button>
              <button class="theme-btn" data-theme="pastel">Pastel</button>
              <button class="theme-btn" data-theme="dark">Dark Matte</button>
              <button class="theme-btn" data-theme="cyberpunk">Cyberpunk</button>
              <button class="theme-btn" data-theme="minimal">Minimal</button>
            </div>
            <span class="theme-note">Changing themes may unlock hidden achievements.</span>
          </div>

          <div class="settings-row">
            <label>Background colour (overrides theme background)</label>
            <input type="color" id="bgColorInput" value="#050816">
          </div>
          <div class="settings-row">
            <label>Background image</label>
            <input type="file" id="bgFileInput" accept="image/*">
          </div>
          <div class="settings-row">
            <label>App name</label>
            <input type="text" id="appNameInput" placeholder="Blacklingo">
            <button id="changeAppNameBtn" class="small-btn">Apply</button>
          </div>
        </div>
      </section>

      <!-- Share -->
      <section id="shareSection">
        <div class="card">
          <h2>Share & Backup</h2>
          <div class="settings-row">
            <button id="downloadBtn" class="small-btn">Download data</button>
            <input type="file" id="uploadDataInput" accept="application/json">
            <button id="uploadBtn" class="small-btn">Load data</button>
          </div>
          <div class="settings-row">
            <button class="small-btn" onclick="shareApp()">Share app link</button>
          </div>
        </div>
      </section>

      <!-- Extras -->
      <section id="extrasSection">
        <div class="extras-grid-bg" id="extrasGridBg"></div>
        <div class="extras-grid-lines"></div>
        <div class="extras-scanlines"></div>

        <div class="extras-content">
          <div class="card" id="extrasMainCard">
            <div class="card-header">
              <h2 id="extrasTitle">Extras ¬∑ Neon Grid</h2>
              <span class="pill" id="extrasHintPill">Tap, explore, experiment‚Ä¶</span>
            </div>

            <div class="extras-row">
              <!-- Daily Quote -->
              <div class="extras-card" id="extrasQuoteCard">
                <h3>Daily Quote</h3>
                <div class="extras-sub">Updates once per day ¬∑ Come back tomorrow</div>
                <div class="extras-quote" id="dailyQuoteText">Loading quote‚Ä¶</div>
                <div class="extras-quote-author" id="dailyQuoteAuthor"></div>
                <div class="extras-hint">Reading quotes often may unlock something.</div>
              </div>

              <!-- Mood -->
              <div class="extras-card" id="extrasMoodCard">
                <h3>Today's Mood</h3>
                <div class="extras-sub">Pick how you feel ¬∑ New dates inherit this mood</div>
                <div id="currentMoodLabel" style="font-size:13px;margin-bottom:4px;">Current mood: None</div>
                <div class="extras-mood-row">
                  <button class="mood-btn" data-mood="üòä Happy">üòä Happy</button>
                  <button class="mood-btn" data-mood="üòê Neutral">üòê Neutral</button>
                  <button class="mood-btn" data-mood="üòî Tired">üòî Tired</button>
                  <button class="mood-btn" data-mood="üî• Motivated">üî• Motivated</button>
                  <button class="mood-btn" data-mood="üß† Focused">üß† Focused</button>
                  <button class="mood-btn" data-mood="üåß Moody">üåß Moody</button>
                </div>
                <div class="extras-hint">Try changing your mood on different days.</div>
              </div>

              <!-- Secret Code -->
              <div class="extras-card" id="extrasSecretCard">
                <h3>Secret Console</h3>
                <div class="extras-sub">Enter secret codes ¬∑ Some are hidden in the app</div>
                <div class="extras-secret-input">
                  <input type="text" id="secretCodeInput" placeholder="Enter secret code">
                  <button id="secretCodeBtn">Run</button>
                </div>
                <div id="secretCodeResult" style="font-size:11px;margin-top:4px;opacity:0.9;"></div>
                <div class="extras-hint">Hint: Try something related to the app's name.</div>
              </div>

              <!-- Theme stats / Easter egg hints -->
              <div class="extras-card" id="extrasStatsCard">
                <h3>Theme & Easter Stats</h3>
                <div class="extras-sub">See how you use Blacklingo</div>
                <div class="extras-theme-stats">
                  <span id="themeChangesStat">Theme changes: 0</span>
                  <span id="themeUsedStat">Themes used: ‚Äì</span>
                  <span id="moodUsedStat">Moods used: ‚Äì</span>
                  <span id="quotesViewedStat">Quotes viewed: 0</span>
                </div>
                <div class="extras-hint">
                  Some secrets hide behind:
                  <br>¬∑ Tapping the Extras title
                  <br>¬∑ Tapping the neon grid
                  <br>¬∑ Changing themes a lot
                  <br>¬∑ Adding dates at unusual times
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

    </div>
  </main>

  <footer>
    Blacklingo ¬∑ PWA ¬∑ Your dates, moods, countdowns, and neon achievements.
  </footer>

  <!-- Achievement Popup -->
  <div id="achievementPopup">
    <div id="achievementPopupInner">
      <div id="achievementPopupTitle">Achievement unlocked</div>
      <div id="achievementPopupName"></div>
      <div id="achievementPopupRarity"></div>
      <div id="achievementPopupDesc"></div>
    </div>
  </div>

  <script>
    // ===== AUTH MANAGER =====
    class UserManager {
      constructor() {
        this.currentUserKey = 'blacklingoCurrentUser';
      }

      getCurrentUser() {
        return localStorage.getItem(this.currentUserKey);
      }

      logout() {
        localStorage.removeItem(this.currentUserKey);
        window.location.href = 'login.html';
      }
    }

    const userManager = new UserManager();
    const currentUsername = userManager.getCurrentUser();

    // Check if user is logged in
    if (!currentUsername) {
      window.location.href = 'login.html';
    }

    // Display username in header
    document.getElementById('usernameDisplay').textContent = currentUsername;

    // ===== LOGOUT FUNCTION =====
    function logoutUser() {
      if (confirm('Are you sure you want to logout?')) {
        userManager.logout();
      }
    }

    // ===== STORAGE HELPER (USER-SPECIFIC) =====
    const userDataKey = (key) => `${currentUsername}_${key}`;

    // --- Navigation ---
    function showSection(sectionId){
      document.getElementById('landing').style.display='none';
      document.getElementById('mainApp').style.display='block';
      document.querySelectorAll("section").forEach(s=>s.style.display='none');
      document.getElementById(sectionId).style.display='block';
    }
    function goHome(){
      document.getElementById('mainApp').style.display='none';
      document.getElementById('landing').style.display='flex';
      document.querySelectorAll("section").forEach(s=>s.style.display='none');
    }

    // --- Data ---
    let dates = JSON.parse(localStorage.getItem(userDataKey("blacklingoDates"))) || [];
    let history = JSON.parse(localStorage.getItem(userDataKey("blacklingoHistory"))) || [];
    let badges = JSON.parse(localStorage.getItem(userDataKey("blacklingoBadges"))) || [];
    let savedCountdowns = JSON.parse(localStorage.getItem(userDataKey("blacklingoCountdowns"))) || [];

    // Streak data
    let streakData = JSON.parse(localStorage.getItem(userDataKey("blacklingoStreak"))) || {
      lastActiveDate: null,
      currentStreak: 0,
      bestStreak: 0
    };

    // Theme data
    let themeState = JSON.parse(localStorage.getItem(userDataKey("blacklingoThemeState"))) || {
      currentTheme: "neon",
      changes: 0,
      usedThemes: []
    };

    // Mood data
    let moodState = JSON.parse(localStorage.getItem(userDataKey("blacklingoMoodState"))) || {
      currentMood: null,
      usedMoods: [],
      moodChanges: 0
    };

    // Daily quote data
    let quoteState = JSON.parse(localStorage.getItem(userDataKey("blacklingoQuoteState"))) || {
      lastDate: null,
      quoteIndex: null,
      views: 0
    };

    // Extras taps
    let extrasTapState = JSON.parse(localStorage.getItem(userDataKey("blacklingoExtrasTaps"))) || {
      titleTaps: 0,
      gridTaps: 0
    };

    // Achievements with rarity + description
    const ACHIEVEMENTS = [
      {id:"day1", threshold:1, label:"ü•á Day 1 Starter", rarity:"common", desc:"You added your first date."},
      {id:"week1", threshold:7, label:"üèÖ Week 1 Warrior", rarity:"rare", desc:"You've tracked at least 7 dates."},
      {id:"month1", threshold:30, label:"üéñ Month 1 Master", rarity:"epic", desc:"30 dates tracked. You're committed."},
      {id:"hundred", threshold:100, label:"üèÜ Century Champ", rarity:"epic", desc:"100 dates tracked. That's huge."},
      {id:"year1", threshold:365, label:"üëë Year 1 Hero", rarity:"legendary", desc:"365 dates tracked. A full year of moments."},
      {id:"countdownSaved", threshold:1, label:"‚è≥ Countdown Keeper", rarity:"rare", desc:"You saved your first countdown."},
      {id:"bgChanged", threshold:1, label:"üé® Theme Shifter", rarity:"rare", desc:"You customised your background."},
      {id:"sharedApp", threshold:1, label:"üì§ Signal Booster", rarity:"epic", desc:"You shared Blacklingo with someone."},
      {id:"streak3", threshold:3, label:"üî• 3-Day Streak", rarity:"common", desc:"You've kept a 3-day streak."},
      {id:"streak7", threshold:7, label:"‚ö° 7-Day Streak", rarity:"rare", desc:"A full week of activity."},
      {id:"streak30", threshold:30, label:"üíé 30-Day Streak", rarity:"epic", desc:"30 days of consistency."},
      {id:"streak100", threshold:100, label:"üåü 100-Day Streak", rarity:"legendary", desc:"100 days in a row. Unreal."},
      {id:"themeAddict", threshold:5, label:"üé≠ Theme Addict", rarity:"rare", desc:"You changed themes 5 times."},
      {id:"themeExplorer", threshold:5, label:"üåà Theme Explorer", rarity:"epic", desc:"You tried all available themes."},
      {id:"secretFinder", threshold:1, label:"üîÆ Secret Finder", rarity:"epic", desc:"You uncovered a hidden secret."},
      {id:"mysteryTapper", threshold:1, label:"üëÅ Mystery Tapper", rarity:"rare", desc:"You tapped where others wouldn't."},
      {id:"nightOwl", threshold:1, label:"üåô Night Owl", rarity:"epic", desc:"You added a date at midnight."},
      {id:"moodMaster", threshold:3, label:"üòä Mood Master", rarity:"rare", desc:"You've used multiple moods across days."},
      {id:"quoteCollector", threshold:5, label:"üìú Quote Collector", rarity:"epic", desc:"You've viewed many daily quotes."}
    ];

    const QUOTES = [
      {text:"Small steps every day become big changes over time.", author:"Unknown"},
      {text:"You don't have to feel ready to begin.", author:"Unknown"},
      {text:"Your future self is watching what you do today.", author:"Unknown"},
      {text:"Discipline is remembering what you want.", author:"David Campbell"},
      {text:"You are allowed to be both a masterpiece and a work in progress.", author:"Sophia Bush"},
      {text:"Action is the antidote to anxiety.", author:"Unknown"},
      {text:"One day or day one. You decide.", author:"Unknown"},
      {text:"The secret of getting ahead is getting started.", author:"Mark Twain"},
      {text:"Done is better than perfect.", author:"Sheryl Sandberg"},
      {text:"Your pace is valid. Your progress is real.", author:"Unknown"}
    ];

    function saveAll(){
      localStorage.setItem(userDataKey("blacklingoDates"),JSON.stringify(dates));
      localStorage.setItem(userDataKey("blacklingoHistory"),JSON.stringify(history));
      localStorage.setItem(userDataKey("blacklingoBadges"),JSON.stringify(badges));
      localStorage.setItem(userDataKey("blacklingoCountdowns"),JSON.stringify(savedCountdowns));
      localStorage.setItem(userDataKey("blacklingoStreak"),JSON.stringify(streakData));
      localStorage.setItem(userDataKey("blacklingoThemeState"),JSON.stringify(themeState));
      localStorage.setItem(userDataKey("blacklingoMoodState"),JSON.stringify(moodState));
      localStorage.setItem(userDataKey("blacklingoQuoteState"),JSON.stringify(quoteState));
      localStorage.setItem(userDataKey("blacklingoExtrasTaps"),JSON.stringify(extrasTapState));
    }

    // --- Time calculation ---
    function calculateTime(dateStr){
      const date = new Date(dateStr);
      const now = new Date();
      const diff = date - now;
      const days = Math.floor(Math.abs(diff) / (1000 * 60 * 60 * 24));
      if (diff < 0) return { text: `${days} days ago`, days: -days };
      if (diff > 0) return { text: `${days} days left`, days: days };
      return { text: "Today", days: 0 };
    }

    // --- Streak logic ---
    function todayKey(){
      const d = new Date();
      return d.toISOString().slice(0,10);
    }

    function updateStreak(){
      const today = todayKey();
      if(!streakData.lastActiveDate){
        streakData.lastActiveDate = today;
        streakData.currentStreak = 1;
        streakData.bestStreak = 1;
      } else {
        if(streakData.lastActiveDate === today){
          // already counted today
        } else {
          const last = new Date(streakData.lastActiveDate);
          const now = new Date(today);
          const diffDays = Math.round((now - last)/(1000*60*60*24));
          if(diffDays === 1){
            streakData.currentStreak += 1;
          } else if(diffDays > 1){
            streakData.currentStreak = 1;
          }
          streakData.lastActiveDate = today;
          if(streakData.currentStreak > streakData.bestStreak){
            streakData.bestStreak = streakData.currentStreak;
          }
        }
      }
      saveAll();
      renderStreak();
      checkStreakAchievements();
    }

    function renderStreak(){
      const pill = document.getElementById("streakPill");
      pill.textContent = `Streak: ${streakData.currentStreak} ¬∑ Best: ${streakData.bestStreak}`;
    }

    function checkStreakAchievements(){
      const s = streakData.currentStreak;
      const map = [
        {id:"streak3", threshold:3},
        {id:"streak7", threshold:7},
        {id:"streak30", threshold:30},
        {id:"streak100", threshold:100}
      ];
      map.forEach(m=>{
        if(s >= m.threshold) unlockAchievement(m.id);
      });
    }

    // --- Achievements UI ---
    function rarityClass(r){
      if(r==="rare") return "rarity-rare";
      if(r==="epic") return "rarity-epic";
      if(r==="legendary") return "rarity-legendary";
      return "rarity-common";
    }

    function updateBadges(){
      const list=document.getElementById("badgeList");
      list.innerHTML="";
      ACHIEVEMENTS.forEach(a=>{
        const li=document.createElement("li");
        li.className="achievement-item " + (badges.includes(a.id) ? "earned" : "unearned");
        const left=document.createElement("div");
        left.className="achievement-left";
        const name=document.createElement("
